{"version":3,"sources":["webpack:///./main.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,qFAAwB;AACxB,oDAAmB;AACnB,MAAM,aAAa;IAmBf;QAjBQ,iBAAY,GAAiB,IAAI;QACjC,aAAQ,GAAiB,IAAI;QAC7B,gBAAW,GAAgB,IAAI;QAC/B,WAAM,GAA+B,IAAI;QACzC,cAAS,GAAwB,IAAI;QACtC,gBAAW,GAAW,MAAM,CAAC,UAAU,GAAG,EAAE;QAC5C,iBAAY,GAAW,MAAM,CAAC,WAAW,GAAG,GAAG;QAC9C,kBAAa,GAAe,IAAI;QAGvB,sBAAiB,GAAG,GAAG;QACvB,oBAAe,GAAG,EAAE;QAC7B,YAAO,GAAG,EAAE,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;QAClF,YAAO,GAAG,EAAE,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;QAE5E,gBAAW,GAAY,KAAK;QAGhC,IAAI,CAAC,2BAA2B,EAAE;QAClC,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5G,CAAC;IAEa,2BAA2B;;YACrC,IAAI;gBAEA,IAAI,CAAC,WAAW,GAAG,MAAM,SAAS,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;aAE9F;YACD,OAAO,KAAK,EAAE;gBAEV,MAAM,KAAK;aAEd;QACL,CAAC;KAAA;IAEO,sBAAsB;QAE1B,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACnB,IAAI,CAAC,YAAY,GAAG,IAAI,YAAY,EAAE;YAEtC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,uBAAuB,CAAC,IAAI,CAAC,WAAW,CAAC;YACzE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE;YAClD,uEAAuE;YAEvE,sCAAsC;YACtC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC;YAClC,wDAAwD;YAExD,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;YAEpD,yEAAyE;YACzE,IAAI,CAAC,WAAW,GAAG,IAAI;YAEvB,IAAI,CAAC,SAAS,EAAE;SACnB;aAAM;YACH,OAAO,CAAC,wCAAwC,CAAC;SACpD;IACL,CAAC;IAEO,SAAS;QACb,IAAI,CAAC,aAAa,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC;QAEpE,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC,IAAI,CAAC,aAAa,CAAC;QAEtD,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,WAAW,EAAE;aAC7B,MAAM,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;aAChB,KAAK,CAAC,CAAC,CAAC,QAAQ,EAAE,KAAK,EAAE,OAAO,CAAC,CAAQ,CAAC;QAE/C,wHAAwH;QAExH,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC,WAAW,EAAE;aAC1B,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;aACtC,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAEjC,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC;aAChD,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC;aAC/B,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC;aACnB,OAAO,CAAC,gBAAgB,EAAE,IAAI,CAAC;QAChC,SAAS;QACT,gCAAgC;QAChC,qBAAqB;QACrB,6CAA6C;QAE7C,uBAAuB;QACvB,mCAAmC;QACnC,YAAY;QACZ,IAAI;QAER,MAAM,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;QAC3C,MAAM,EAAE,GAAG,CAAC,GAAG,GAAG;QAClB,uBAAuB;QACvB,IAAI,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,MAAM,CAAC;aACjC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,KAAK,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC;aAC/C,KAAK,CAAC,MAAM,EAAE,CAAC,KAAU,EAAE,KAAU,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YAClE,iDAAiD;YACjD,uCAAuC;aACtC,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,sCAAsC;aAC7D,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC;aACd,IAAI,CAAC,GAAG,EAAE,CAAC,KAAU,EAAE,KAAU,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;aAC1D,IAAI,CAAC,GAAG,EAAE,CAAC,KAAU,EAAE,KAAU,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;aAC1D,IAAI,CAAC,QAAQ,EAAE,CAAC,KAAU,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE;aAC1E,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;aAClB,UAAU,EAAE;aACZ,QAAQ,CAAC,CAAC,CAAC;aACX,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC;aACnB,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC;QAEzB,MAAM,SAAS,GAAG,GAAG,EAAE;YACnB,qBAAqB,CAAC,SAAS,CAAC;YAEhC,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC,IAAI,CAAC,aAAa,CAAC;YAEtD,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,MAAM,CAAC;iBACrB,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC;iBACxB,UAAU,EAAE;iBACZ,QAAQ,CAAC,CAAC,CAAC;iBACX,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC;iBACnB,KAAK,CAAC,MAAM,EAAE,CAAC,KAAU,EAAE,KAAU,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;iBAEjE,IAAI,CAAC,GAAG,EAAE,CAAC,KAAU,EAAE,KAAU,EAAE,EAAE,CAAC,IAAI,CAAC,YAAY,GAAG,CAAC,GAAG,KAAK,CAAC;iBACpE,IAAI,CAAC,QAAQ,EAAE,CAAC,KAAU,EAAE,KAAU,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;QAC5F,CAAC;QAED,SAAS,EAAE;IAEf,CAAC;IAGO,4BAA4B;QAChC,IAAI,CAAC,WAAW,CAAC,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC;IACrE,CAAC;IAEO,mBAAmB,CAAC,KAAU;QAClC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC;IACtB,CAAC;CAEJ;AAED,MAAM,SAAS,GAAG,IAAI,aAAa,EAAE","file":"main.83646cf0be452d40d2e0.hot-update.js","sourcesContent":["import * as d3 from 'd3'\nimport './main.css'\nclass WaveGenerator {\n\n    private audioContext: AudioContext = null\n    private analyser: AnalyserNode = null\n    private mediaStream: MediaStream = null\n    private source: MediaStreamAudioSourceNode = null\n    private processor: ScriptProcessorNode = null\n    public windowWidth: number = window.innerWidth - 10\n    public windowHeight: number = window.innerHeight - 100\n    private frequencyData: Uint8Array = null\n    private colorScale: any\n    private circleX: any\n    private readonly frequencyBinCount = 128\n    private readonly maxStdAmplitude = 16\n    private xScaler = d3.scaleLinear().domain([0, this.frequencyBinCount - 1]).range([0, 200])\n    private yScaler = d3.scaleLinear().domain([0, this.maxStdAmplitude]).range([185, 0])\n    private svg: any\n    private isListening: boolean = false\n\n    constructor() {\n        this.setMicrophoneAudioToContext()\n        document.getElementById('start-waves').addEventListener('click', this.initializeAudioContext.bind(this))\n    }\n\n    private async setMicrophoneAudioToContext() {\n        try {\n\n            this.mediaStream = await navigator.mediaDevices.getUserMedia({ audio: true, video: false })\n\n        }\n        catch (error) {\n\n            throw error\n\n        }\n    }\n\n    private initializeAudioContext() {\n\n        if (!this.isListening) {\n            this.audioContext = new AudioContext()\n    \n            this.source = this.audioContext.createMediaStreamSource(this.mediaStream)\n            this.analyser = this.audioContext.createAnalyser()\n            // this.processor = this.audioContext.createScriptProcessor(1024, 1, 1)\n    \n            // this.source.connect(this.processor)\n            this.source.connect(this.analyser)\n            // this.processor.connect(this.audioContext.destination)\n    \n            this.analyser.connect(this.audioContext.destination)\n    \n            // this.processor.onaudioprocess = this.generateGraphFromAudio.bind(this)\n            this.isListening = true\n\n            this.initChart()\n        } else {\n            confirm(\"An audio context is already configured\")\n        }\n    }\n\n    private initChart() {\n        this.frequencyData = new Uint8Array(this.analyser.frequencyBinCount)\n\n        this.analyser.getByteFrequencyData(this.frequencyData)\n\n        this.colorScale = d3.scaleLinear()\n            .domain([0, 150])\n            .range(([\"purple\", \"red\", \"green\"]) as any)\n\n        // this.colorScale = d3.scaleSequential(d3.interpolateYlGnBu).domain(d3.extent(this.frequencyData, (d: any) => d.value))\n\n        this.circleX = d3.scaleLinear()\n            .domain([0, this.frequencyData.length])\n            .range([0, this.windowWidth])\n\n        this.svg = d3.select('#wave-container').append('svg')\n            .attr('width', this.windowWidth)\n            .attr('height', 250)\n            .classed('graph__outline', true)\n            // .call(\n            //     d3.axisLeft(this.yScaler)\n            //         .ticks(30)\n            //         .tickSize(-this.windowWidth / 1.1)\n\n            //         .tickFormat(\n            //             d3.format(\"\" as any)\n            //         )\n            // )\n\n        const w = this.xScaler(1) - this.xScaler(0)\n        const rx = w * 0.1\n        // logic for rectangles\n        let rects = this.svg.selectAll('rect')\n            .data(this.frequencyData).enter().append('rect')\n            .style('fill', (datum: any, index: any) => this.colorScale(datum))\n            // .style('transition-timing-function', 'linear')\n            // .style('transition-duration', '5ms')\n            .attr('width', () => w) // this.windowWidth / data.length + .3\n            .attr('rx', rx)\n            .attr('x', (datum: any, index: any) => this.xScaler(index))\n            .attr('y', (datum: any, index: any) => this.yScaler(datum))\n            .attr('height', (datum: any) => (this.yScaler(0) - this.yScaler(datum))) //\n            .attr('opacity', 0)\n            .transition()\n            .duration(0)\n            .ease(d3.easeLinear)\n            .attr('opacity', 0.6)\n\n        const drawChart = () => {\n            requestAnimationFrame(drawChart)\n\n            this.analyser.getByteFrequencyData(this.frequencyData)\n\n            this.svg.selectAll('rect')\n                .data(this.frequencyData)\n                .transition()\n                .duration(5)\n                .ease(d3.easeLinear)\n                .style('fill', (datum: any, index: any) => this.colorScale(datum))\n\n                .attr('y', (datum: any, index: any) => this.windowHeight / 4 - datum)\n                .attr('height', (datum: any, index: any) => (this.yScaler(0) - this.yScaler(datum)))\n        }\n\n        drawChart()\n        \n    }\n\n\n    private initializeUserMediaListeners() {\n        this.mediaStream.onaddtrack = this.addMediaStreamTrack.bind(this)\n    }\n\n    private addMediaStreamTrack(event: any) { // MediaStreamTrackEvent\n        console.log(event)\n    }\n\n}\n\nconst generator = new WaveGenerator()\n"],"sourceRoot":""}